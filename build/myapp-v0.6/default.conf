http {
    map $arg_code $status_code {
        default   200;
        "~^[0-9]+$" $arg_code;  # Ensure that the code is numeric
    }

    server {
        listen 8080;
        server_name localhost;

        location / {
            add_header Content-Type text/plain;
            return 200 "hello world v0.6\n$hostname\n";
        }

        location /health {
            # Use the mapped status code
            return $status_code "health checker v0.6\n$hostname\n";
        }
    }
}